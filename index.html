<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TenseMaster | English Grammar Course</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Outfit:wght@500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        h1, h2, h3, h4, .brand-font {
            font-family: 'Outfit', sans-serif;
        }
        
        /* Smooth background animations */
        @keyframes float {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }

        @keyframes float-reverse {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(-30px, 50px) scale(1.2); }
            66% { transform: translate(20px, -20px) scale(0.8); }
            100% { transform: translate(0px, 0px) scale(1); }
        }

        .blob {
            position: absolute;
            filter: blur(80px);
            opacity: 0.6;
            z-index: -1;
            animation: float 20s infinite ease-in-out;
        }

        .blob-2 {
            animation: float-reverse 25s infinite ease-in-out;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        /* Glassmorphism Utilities */
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-800 overflow-x-hidden min-h-screen relative selection:bg-fuchsia-300 selection:text-fuchsia-900">

    <!-- Background Elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="blob bg-purple-600 w-96 h-96 rounded-full top-0 left-0 mix-blend-multiply opacity-50"></div>
        <div class="blob-2 bg-pink-500 w-96 h-96 rounded-full bottom-0 right-0 mix-blend-multiply opacity-50"></div>
        <div class="blob bg-indigo-500 w-80 h-80 rounded-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 mix-blend-multiply opacity-50"></div>
    </div>

    <!-- Navigation -->
    <nav class="fixed w-full z-50 top-0 left-0 border-b border-white/20 bg-slate-900/80 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-2 cursor-pointer" onclick="app.navigate('home')">
                    <i class="ph-fill ph-graduation-cap text-3xl text-fuchsia-400"></i>
                    <span class="brand-font text-xl font-bold text-white tracking-wide">Tense<span class="text-fuchsia-400">Master</span></span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-2">
                        <button onclick="app.navigate('home')" class="nav-btn text-white hover:bg-white/10 px-3 py-2 rounded-md text-sm font-medium transition-colors">Home</button>
                        <button onclick="app.navigate('present')" class="nav-btn text-gray-300 hover:text-white hover:bg-white/10 px-3 py-2 rounded-md text-sm font-medium transition-colors">Present</button>
                        <button onclick="app.navigate('past')" class="nav-btn text-gray-300 hover:text-white hover:bg-white/10 px-3 py-2 rounded-md text-sm font-medium transition-colors">Past</button>
                        <button onclick="app.navigate('perfect')" class="nav-btn text-gray-300 hover:text-white hover:bg-white/10 px-3 py-2 rounded-md text-sm font-medium transition-colors">Pres. Perfect</button>
                        <button onclick="app.navigate('pastPerfect')" class="nav-btn text-gray-300 hover:text-white hover:bg-white/10 px-3 py-2 rounded-md text-sm font-medium transition-colors">Past Perfect</button>
                        <!-- Removed Compare Button from Nav -->
                        <button onclick="app.navigate('practice')" class="nav-btn bg-gradient-to-r from-fuchsia-600 to-purple-600 hover:from-fuchsia-500 hover:to-purple-500 text-white px-4 py-2 rounded-full text-sm font-bold shadow-lg transition-all transform hover:scale-105">Quiz</button>
                    </div>
                </div>
                <!-- Mobile menu button -->
                <div class="md:hidden">
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-gray-300 hover:text-white p-2">
                        <i class="ph ph-list text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-slate-800 border-t border-slate-700">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button onclick="app.navigate('home')" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left">Home</button>
                <button onclick="app.navigate('present')" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left">Present Tenses</button>
                <button onclick="app.navigate('past')" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left">Past Tenses</button>
                <button onclick="app.navigate('perfect')" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left">Present Perfect</button>
                <button onclick="app.navigate('pastPerfect')" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium w-full text-left">Past Perfect</button>
                <!-- Removed Compare Button from Mobile Menu -->
                <button onclick="app.navigate('practice')" class="text-fuchsia-400 font-bold block px-3 py-2 rounded-md text-base w-full text-left">Practice Quiz</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="app-container" class="pt-24 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto min-h-screen flex flex-col">
        <!-- Content injected here via JS -->
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900/90 backdrop-blur text-gray-400 py-8 border-t border-white/10 relative z-10">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-sm">Based on concepts from "English Grammar in Use" (Murphy) & Supplementary Exercises.</p>
            <p class="text-xs mt-2 opacity-60">Designed for EFL/ESL Students.</p>
        </div>
    </footer>

    <!-- JavaScript Application Logic -->
    <script>
        // --- Data Source (Based on PDFs & EnglishPage.com) ---
        const contentData = {
            home: {
                title: "Master English Tenses",
                subtitle: "Interactive grammar guide based on Cambridge Grammar in Use",
                cards: [
                    { title: "Present Tenses", desc: "I do vs I am doing", icon: "ph-clock", action: "present", color: "from-blue-400 to-indigo-500" },
                    { title: "Past Tenses", desc: "I did vs I was doing", icon: "ph-clock-counter-clockwise", action: "past", color: "from-pink-400 to-rose-500" },
                    { title: "Present Perfect", desc: "I have done / been doing", icon: "ph-check-square-offset", action: "perfect", color: "from-emerald-400 to-teal-500" },
                    { title: "Past Perfect", desc: "I had done / been doing", icon: "ph-arrow-u-up-left", action: "pastPerfect", color: "from-violet-400 to-fuchsia-500" }
                ]
            },
            present: {
                title: "Present Tenses",
                intro: "Learn when to use the Simple Present and Present Continuous.",
                units: [
                    {
                        title: "Present Simple",
                        subtitle: "I do",
                        formula: "Subject + verb (s/es)",
                        explanation: "Use this for things that are true in general, or for things that happen repeatedly (habits).",
                        practiceLink: "present_simple_hub", 
                        detailedUses: [
                            { title: "1. Repeated Actions", desc: "Habits, hobbies, daily events, or scheduled events. (e.g., 'I play tennis', 'The train leaves at 8 AM')." },
                            { title: "2. Facts or Generalizations", desc: "General truths about people or things. (e.g., 'Cats like milk', 'Windows are made of glass')." },
                            { title: "3. Scheduled Events (Near Future)", desc: "Often used for public transportation or fixed schedules. (e.g., 'The party starts at 8 o'clock')." },
                            { title: "4. Now (Non-Continuous Verbs)", desc: "For verbs not used in continuous forms (like 'need', 'want', 'know'). (e.g., 'He needs help right now')." }
                        ],
                        examples: [
                            "Nurses <b>look</b> after patients in hospitals.",
                            "I usually <b>go</b> away at weekends.",
                            "The cafe <b>opens</b> at 7:30 in the morning."
                        ],
                        icon: "ph-repeat"
                    },
                    {
                        title: "Present Continuous",
                        subtitle: "I am doing",
                        formula: "Subject + am/is/are + verb-ing",
                        explanation: "Use this for an action happening <b>now</b> (at the time of speaking) or around now. The action is not finished.",
                        practiceLink: "present_continuous_hub",
                        detailedUses: [
                            { title: "1. Now", desc: "Something is happening at this very moment. (e.g., 'You are learning English now')." },
                            { title: "2. Longer Actions in Progress", desc: "An action in progress this week, month, or year, but not necessarily right this second. (e.g., 'I am studying to become a doctor')." },
                            { title: "3. Near Future", desc: "Indicates that something will or will not happen in the near future. (e.g., 'I am meeting some friends after work')." },
                            { title: "4. Trends & Changes", desc: "Describing a changing situation. (e.g., 'My English is getting better')." }
                        ],
                        examples: [
                            "Sarah is in her car. She <b>is driving</b> to work.",
                            "Please don't make noise. I <b>am trying</b> to work.",
                            "Look! It <b>is raining</b>."
                        ],
                        icon: "ph-spinner"
                    }
                ]
            },
            presentSimplePractice: [
                {
                    id: 'habits',
                    title: "Habits & Repeated Actions",
                    desc: "Daily routines, hobbies, and things you do often.",
                    questions: [
                        { q: "I usually ______ (go) away at weekends.", options: ["go", "goes", "going"], correct: 0, feedback: "Correct! 'Usually' indicates a habit." },
                        { q: "On weekdays, I ______ (catch) the bus.", options: ["catches", "catch", "catching"], correct: 1, feedback: "Correct! 'I' takes the base form." },
                        { q: "He ______ (play) tennis every Friday.", options: ["play", "playing", "plays"], correct: 2, feedback: "Correct! Third person singular (He) adds 's'." },
                        { q: "They often ______ (visit) their grandparents.", options: ["visit", "visits", "visiting"], correct: 0, feedback: "Correct! 'Often' signals a repeated action." },
                        { q: "She never ______ (forget) her purse.", options: ["forget", "forgets", "forgot"], correct: 1, feedback: "Correct! 'Never' is an adverb of frequency used with habits." },
                        { q: "We ______ (watch) TV in the evening.", options: ["watch", "watches", "watching"], correct: 0, feedback: "Correct! 'We' takes the base form." },
                        { q: "My brother ______ (live) in London.", options: ["live", "lives", "living"], correct: 1, feedback: "Correct! A permanent situation/habit." },
                        { q: "Tom ______ (have) a shower every morning.", options: ["haves", "has", "have"], correct: 1, feedback: "Correct! 'Has' is the 3rd person form of 'have'." },
                        { q: "I ______ (work) in a bank.", options: ["works", "working", "work"], correct: 2, feedback: "Correct! A general habit/fact about your life." },
                        { q: "Sarah ______ (drive) to work every day.", options: ["drive", "drives", "is driving"], correct: 1, feedback: "Correct! 'Every day' implies a habit." }
                    ]
                },
                {
                    id: 'facts',
                    title: "Facts & General Truths",
                    desc: "Things that are always true or true in general.",
                    questions: [
                        { q: "The earth ______ (go) round the sun.", options: ["goes", "go", "going"], correct: 0, feedback: "Correct! Scientific fact." },
                        { q: "Nurses ______ (look) after patients in hospitals.", options: ["looks", "look", "looking"], correct: 1, feedback: "Correct! General truth about nurses." },
                        { q: "Cats ______ (like) milk.", options: ["like", "likes", "liking"], correct: 0, feedback: "Correct! General truth about cats." },
                        { q: "Water ______ (boil) at 100 degrees Celsius.", options: ["boils", "boil", "boiled"], correct: 0, feedback: "Correct! Physical fact." },
                        { q: "It ______ (rain) a lot in winter here.", options: ["rain", "rains", "raining"], correct: 1, feedback: "Correct! General weather fact." },
                        { q: "Birds ______ (not / like) milk.", options: ["not like", "doesn't like", "do not like"], correct: 2, feedback: "Correct! Negative fact." },
                        { q: "Canada ______ (share) a border with the USA.", options: ["shares", "share", "sharing"], correct: 0, feedback: "Correct! Geographic fact." },
                        { q: "Windows ______ (be) made of glass.", options: ["is", "are", "be"], correct: 1, feedback: "Correct! General truth." },
                        { q: "The sun ______ (rise) in the East.", options: ["rise", "rises", "rising"], correct: 1, feedback: "Correct! Universal truth." },
                        { q: "Vegetarians ______ (not / eat) meat.", options: ["don't eat", "doesn't eat", "not eat"], correct: 0, feedback: "Correct! General definition." }
                    ]
                },
                {
                    id: 'schedules',
                    title: "Schedules & Timetables",
                    desc: "Future events based on a timetable.",
                    questions: [
                        { q: "My university term ______ (start) in Autumn.", options: ["start", "starts", "starting"], correct: 1, feedback: "Correct! A fixed schedule." },
                        { q: "The train ______ (leave) at 11:30.", options: ["leave", "leaves", "leaving"], correct: 1, feedback: "Correct! Train timetable." },
                        { q: "What time ______ (do) the film begin?", options: ["do", "does", "is"], correct: 1, feedback: "Correct! Question about a schedule." },
                        { q: "The plane ______ (arrive) tonight at 9 PM.", options: ["arrive", "arrives", "arriving"], correct: 1, feedback: "Correct! Flight schedule." },
                        { q: "The concert ______ (finish) at 10:30.", options: ["finishes", "finish", "finished"], correct: 0, feedback: "Correct! Fixed event time." },
                        { q: "School ______ (begin) next week.", options: ["begins", "begin", "beginning"], correct: 0, feedback: "Correct! School calendar." },
                        { q: "The exhibition ______ (open) on the 18th.", options: ["open", "opens", "opening"], correct: 1, feedback: "Correct! Scheduled opening." },
                        { q: "When ______ (do) the bus arrive?", options: ["do", "does", "is"], correct: 1, feedback: "Correct! Bus timetable." },
                        { q: "Our flight ______ (take) off at 7 AM tomorrow.", options: ["takes", "take", "taking"], correct: 0, feedback: "Correct! Flight schedule." },
                        { q: "The football match ______ (start) at 3 PM.", options: ["start", "starts", "starting"], correct: 1, feedback: "Correct! Sports schedule." }
                    ]
                },
                {
                    id: 'states',
                    title: "Non-Continuous (State) Verbs",
                    desc: "Verbs about thoughts, feelings, and possession.",
                    questions: [
                        { q: "I ______ (understand) the problem now.", options: ["understand", "am understanding", "understands"], correct: 0, feedback: "Correct! 'Understand' is a state verb." },
                        { q: "She ______ (want) a new car.", options: ["wants", "is wanting", "want"], correct: 0, feedback: "Correct! 'Want' describes a state/desire." },
                        { q: "Do you ______ (know) the answer?", options: ["know", "knowing", "knows"], correct: 0, feedback: "Correct! 'Know' is a mental state." },
                        { q: "This soup ______ (taste) delicious.", options: ["tastes", "is tasting", "taste"], correct: 0, feedback: "Correct! Describes the state of the soup." },
                        { q: "I ______ (think) he is right.", options: ["think", "am thinking", "thinks"], correct: 0, feedback: "Correct! Opinion = Simple Tense." },
                        { q: "He ______ (need) help with his homework.", options: ["needs", "is needing", "need"], correct: 0, feedback: "Correct! 'Need' is a state verb." },
                        { q: "I ______ (remember) his face.", options: ["remember", "am remembering", "remembers"], correct: 0, feedback: "Correct! Mental process." },
                        { q: "They ______ (own) a farm.", options: ["own", "are owning", "owns"], correct: 0, feedback: "Correct! Possession." },
                        { q: "I ______ (like) this song.", options: ["like", "am liking", "likes"], correct: 0, feedback: "Correct! Preference." },
                        { q: "It ______ (seem) expensive.", options: ["seems", "is seeming", "seem"], correct: 0, feedback: "Correct! Appearance/State." }
                    ]
                }
            ],
            presentContinuousPractice: [
                {
                    id: 'now',
                    title: "Happening Now",
                    desc: "Actions happening at the time of speaking.",
                    questions: [
                        { q: "Please be quiet. I ______ (try) to work.", options: ["try", "am trying", "tried"], correct: 1, feedback: "Correct! Happening right now." },
                        { q: "Look! It ______ (rain).", options: ["rains", "is raining", "rained"], correct: 1, feedback: "Correct! 'Look!' indicates this moment." },
                        { q: "Where's Mark? He ______ (have) a shower.", options: ["is having", "has", "have"], correct: 0, feedback: "Correct! He is doing it now." },
                        { q: "(at a party) Hi, Jane. ______ (you / enjoy) the party?", options: ["Do you enjoy", "Are you enjoying", "You enjoy"], correct: 1, feedback: "Correct! Asking about the current moment." },
                        { q: "What's that noise? What ______ (happen)?", options: ["is happening", "happens", "happen"], correct: 0, feedback: "Correct! Ongoing action." },
                        { q: "Listen! The birds ______ (sing).", options: ["sing", "are singing", "is singing"], correct: 1, feedback: "Correct! 'Listen!' is a clue." },
                        { q: "Don't go out now. It ______ (snow).", options: ["is snowing", "snows", "snowing"], correct: 0, feedback: "Correct! Happening now." },
                        { q: "I ______ (not / watch) TV right now.", options: ["am not watching", "don't watch", "not watching"], correct: 0, feedback: "Correct! Negative action now." },
                        { q: "Why ______ (you / wear) that coat? It's hot!", options: ["do you wear", "are you wearing", "wear you"], correct: 1, feedback: "Correct! You are wearing it now." },
                        { q: "Look at that man! He ______ (run) after the bus.", options: ["runs", "is running", "running"], correct: 1, feedback: "Correct! Visible action." }
                    ]
                },
                {
                    id: 'temporary',
                    title: "Temporary Situations",
                    desc: "Actions in progress around now, but not necessarily this second.",
                    questions: [
                        { q: "I ______ (stay) with friends until I find a flat.", options: ["stay", "am staying", "staying"], correct: 1, feedback: "Correct! A temporary situation." },
                        { q: "My car is broken, so I ______ (walk) to work this week.", options: ["am walking", "walk", "walks"], correct: 0, feedback: "Correct! Temporary routine." },
                        { q: "She ______ (study) Economics at university.", options: ["studies", "is studying", "studying"], correct: 1, feedback: "Correct! In progress over a period of time." },
                        { q: "I ______ (read) a really good book at the moment.", options: ["read", "am reading", "reads"], correct: 1, feedback: "Correct! 'At the moment' implies temporary." },
                        { q: "They ______ (build) a new hotel in the city centre.", options: ["build", "are building", "building"], correct: 1, feedback: "Correct! Ongoing project." },
                        { q: "My sister ______ (look) for a job.", options: ["looks", "is looking", "look"], correct: 1, feedback: "Correct! Temporary activity." },
                        { q: "We ______ (decorate) the house this month.", options: ["are decorating", "decorate", "decorates"], correct: 0, feedback: "Correct! Happening this month." },
                        { q: "He ______ (work) hard on a new project.", options: ["works", "is working", "working"], correct: 1, feedback: "Correct! Specific project duration." },
                        { q: "I ______ (live) with my parents for now.", options: ["live", "am living", "living"], correct: 1, feedback: "Correct! 'For now' means temporary." },
                        { q: "She ______ (write) a book about her travels.", options: ["writes", "is writing", "wrote"], correct: 1, feedback: "Correct! In the middle of doing it." }
                    ]
                },
                {
                    id: 'future',
                    title: "Future Arrangements",
                    desc: "Plans you have already arranged for the future.",
                    questions: [
                        { q: "I ______ (meet) Sarah for lunch tomorrow.", options: ["am meeting", "meet", "meeting"], correct: 0, feedback: "Correct! Arranged plan." },
                        { q: "What ______ (you / do) on Saturday night?", options: ["do you do", "are you doing", "you doing"], correct: 1, feedback: "Correct! Asking about plans." },
                        { q: "We ______ (go) to the cinema tonight.", options: ["go", "are going", "goes"], correct: 1, feedback: "Correct! Definite plan." },
                        { q: "He ______ (play) tennis on Friday.", options: ["plays", "is playing", "play"], correct: 1, feedback: "Correct! Arranged activity." },
                        { q: "They ______ (fly) to Paris next week.", options: ["fly", "are flying", "flying"], correct: 1, feedback: "Correct! Booked travel." },
                        { q: "I ______ (not / work) tomorrow.", options: ["am not working", "don't work", "not work"], correct: 0, feedback: "Correct! Plan not to work." },
                        { q: "______ (you / come) to the party?", options: ["Do you come", "Are you coming", "Coming you"], correct: 1, feedback: "Correct! Asking about attendance." },
                        { q: "She ______ (see) the dentist at 10 AM.", options: ["sees", "is seeing", "see"], correct: 1, feedback: "Correct! Appointment." },
                        { q: "We ______ (have) a barbecue this weekend.", options: ["have", "are having", "having"], correct: 1, feedback: "Correct! Planned event." },
                        { q: "My parents ______ (visit) us next month.", options: ["visit", "are visiting", "visits"], correct: 1, feedback: "Correct! Arranged visit." }
                    ]
                },
                {
                    id: 'changes',
                    title: "Trends & Changes",
                    desc: "Situations that are changing or developing.",
                    questions: [
                        { q: "My English ______ (get) better.", options: ["is getting", "gets", "getting"], correct: 0, feedback: "Correct! Changing state." },
                        { q: "The population of the world ______ (increase).", options: ["increases", "is increasing", "increase"], correct: 1, feedback: "Correct! Trend." },
                        { q: "It ______ (become) harder to find a job.", options: ["becomes", "is becoming", "become"], correct: 1, feedback: "Correct! Developing situation." },
                        { q: "The cost of living ______ (rise).", options: ["rises", "is rising", "rising"], correct: 1, feedback: "Correct! Upward trend." },
                        { q: "The weather ______ (start) to improve.", options: ["starts", "is starting", "starting"], correct: 1, feedback: "Correct! Change in progress." },
                        { q: "My muscles ______ (develop) from all this work!", options: ["develop", "are developing", "develops"], correct: 1, feedback: "Correct! Physical change (from PDF)." },
                        { q: "Technology ______ (change) very fast.", options: ["changes", "is changing", "change"], correct: 1, feedback: "Correct! Rapid change." },
                        { q: "People ______ (live) longer these days.", options: ["live", "are living", "lives"], correct: 1, feedback: "Correct! Changing demographic." },
                        { q: "The days ______ (get) shorter in winter.", options: ["get", "are getting", "getting"], correct: 1, feedback: "Correct! Seasonal change." },
                        { q: "Your French ______ (improve) quickly.", options: ["improves", "is improving", "improve"], correct: 1, feedback: "Correct! Improvement in progress." }
                    ]
                }
            ],
            past: {
                title: "Past Tenses",
                intro: "Distinguishing between finished actions and actions in progress in the past.",
                units: [
                    {
                        title: "Past Simple",
                        subtitle: "I did",
                        formula: "Subject + verb-ed (or irregular)",
                        explanation: "Use this for finished actions in the past. We often say <i>when</i> it happened.",
                        practiceLink: "past_simple_hub",
                        detailedUses: [
                            { title: "1. Completed Action in the Past", desc: "An action started and finished at a specific time in the past. (e.g., 'I saw a movie yesterday')." },
                            { title: "2. A Series of Completed Actions", desc: "A list of completed actions that happened 1st, 2nd, 3rd, etc. (e.g., 'I finished work, walked to the beach, and found a nice place to swim')." },
                            { title: "3. Duration in the Past", desc: "An action that starts and stops in the past, often with expressions like 'for two years'. (e.g., 'I lived in Brazil for two years')." },
                            { title: "4. Habits in the Past", desc: "Habits which stopped in the past. Similar meaning to 'used to'. (e.g., 'I studied French when I was a child')." }
                        ],
                        examples: [
                            "I <b>woke</b> up at 6:00 yesterday.",
                            "We <b>played</b> tennis yesterday afternoon.",
                            "He <b>didn't</b> go to work last week."
                        ],
                        icon: "ph-check-circle"
                    },
                    {
                        title: "Past Continuous",
                        subtitle: "I was doing",
                        formula: "Subject + was/were + verb-ing",
                        explanation: "Use this when you were in the middle of doing something at a certain time in the past.",
                        practiceLink: "past_continuous_hub",
                        detailedUses: [
                            { title: "1. Interrupted Action in the Past", desc: "A longer action in the past was interrupted by a shorter action. (e.g., 'I was watching TV when she called')." },
                            { title: "2. Specific Time as an Interruption", desc: "Last night at 6 PM, I was eating dinner. (I started earlier and was in the process of eating at 6 PM)." },
                            { title: "3. Parallel Actions", desc: "Two actions happening at the same time. (e.g., 'I was studying while he was making dinner')." },
                            { title: "4. Atmosphere", desc: "Using parallel actions to describe the atmosphere. (e.g., 'People were typing, phones were ringing...')." },
                            { title: "5. Repetition with 'Always'", desc: "Irritating or shocking habits in the past. (e.g., 'She was always coming to class late')." }
                        ],
                        examples: [
                            "This time last year I <b>was living</b> in Brazil.",
                            "What <b>were</b> you <b>doing</b> at 10 o'clock last night?",
                            "It <b>was raining</b> when we went out."
                        ],
                        icon: "ph-film-strip"
                    }
                ]
            },
            pastSimplePractice: [
                {
                    id: 'completed',
                    title: "Completed Actions",
                    desc: "Actions that started and finished at a specific time in the past.",
                    questions: [
                        { q: "I ______ (see) a movie yesterday.", options: ["see", "saw", "seen"], correct: 1, feedback: "Correct! Irregular past of 'see'." },
                        { q: "Last year, I ______ (travel) to Japan.", options: ["traveled", "travel", "travelling"], correct: 0, feedback: "Correct! Specific time in the past." },
                        { q: "Did you ______ (have) dinner last night?", options: ["had", "have", "has"], correct: 1, feedback: "Correct! 'Did' takes the base form." },
                        { q: "She ______ (wash) her car on Sunday.", options: ["wash", "washed", "washes"], correct: 1, feedback: "Correct! Completed action." },
                        { q: "He ______ (not / wash) his car.", options: ["didn't wash", "not washed", "didn't washed"], correct: 0, feedback: "Correct! Negative past simple." },
                        { q: "We ______ (go) to the park last weekend.", options: ["go", "went", "gone"], correct: 1, feedback: "Correct! Irregular past of 'go'." },
                        { q: "I ______ (buy) a new phone yesterday.", options: ["buyed", "bought", "buying"], correct: 1, feedback: "Correct! Irregular past of 'buy'." },
                        { q: "They ______ (leave) the party early.", options: ["left", "leaved", "leave"], correct: 0, feedback: "Correct! Irregular past of 'leave'." },
                        { q: "______ (you / sleep) well last night?", options: ["Did you sleep", "Do you sleep", "Slept you"], correct: 0, feedback: "Correct! Past simple question." },
                        { q: "Tom ______ (not / come) to the office yesterday.", options: ["didn't came", "didn't come", "not come"], correct: 1, feedback: "Correct! 'Did not' + base verb." }
                    ]
                },
                {
                    id: 'series',
                    title: "Series of Actions",
                    desc: "A list of completed actions happening one after another.",
                    questions: [
                        { q: "I finished work, ______ (walk) to the beach, and found a nice place to swim.", options: ["walk", "walked", "walking"], correct: 1, feedback: "Correct! Part of a sequence." },
                        { q: "He arrived at 8:00, ______ (check) into the hotel, and met the others.", options: ["checked", "check", "checking"], correct: 0, feedback: "Correct! Sequential past action." },
                        { q: "Did you add flour, ______ (pour) in the milk, and then add eggs?", options: ["poured", "pour", "pouring"], correct: 1, feedback: "Correct! 'Did' applies to the list." },
                        { q: "She opened the box and ______ (look) inside.", options: ["looked", "look", "looking"], correct: 0, feedback: "Correct! Next action in story." },
                        { q: "He woke up, washed his face, and ______ (brush) his teeth.", options: ["brushed", "brush", "brushes"], correct: 0, feedback: "Correct! List of past events." },
                        { q: "I sat down, took a book, and ______ (start) to read.", options: ["start", "started", "starting"], correct: 1, feedback: "Correct! Sequential action." },
                        { q: "The thief broke in, ______ (steal) the TV, and ran away.", options: ["stole", "stealed", "stolen"], correct: 0, feedback: "Correct! Irregular past of 'steal'." },
                        { q: "She put on her coat, ______ (grab) her bag, and left.", options: ["grabbed", "grab", "grabbing"], correct: 0, feedback: "Correct! Sequence of events." },
                        { q: "We bought tickets, ______ (enter) the cinema, and sat down.", options: ["entered", "enter", "entering"], correct: 0, feedback: "Correct! Narrative sequence." },
                        { q: "He paid the bill, ______ (stand) up, and walked out.", options: ["stood", "standed", "stand"], correct: 0, feedback: "Correct! Irregular past of 'stand'." }
                    ]
                },
                {
                    id: 'duration',
                    title: "Duration in Past",
                    desc: "Actions that lasted for a time in the past but are now finished.",
                    questions: [
                        { q: "I ______ (live) in Brazil for two years.", options: ["lived", "live", "living"], correct: 0, feedback: "Correct! Finished duration." },
                        { q: "Shauna ______ (study) Japanese for five years.", options: ["studied", "studies", "studying"], correct: 0, feedback: "Correct! Past duration." },
                        { q: "They ______ (sit) at the beach all day.", options: ["sat", "sit", "sitted"], correct: 0, feedback: "Correct! Irregular past of 'sit'." },
                        { q: "We ______ (talk) on the phone for thirty minutes.", options: ["talked", "talk", "talking"], correct: 0, feedback: "Correct! Specific duration in past." },
                        { q: "How long ______ (you / wait) for them?", options: ["did you wait", "do you wait", "waited you"], correct: 0, feedback: "Correct! Question about duration." },
                        { q: "I ______ (work) there for 10 years before I quit.", options: ["worked", "work", "working"], correct: 0, feedback: "Correct! Finished period." },
                        { q: "She ______ (be) sick for a week.", options: ["was", "is", "were"], correct: 0, feedback: "Correct! Past state duration." },
                        { q: "We ______ (stay) at the party for only an hour.", options: ["stayed", "stay", "staying"], correct: 0, feedback: "Correct! Short duration in past." },
                        { q: "He ______ (play) football for the school team for 3 years.", options: ["played", "play", "playing"], correct: 0, feedback: "Correct! Past habit/duration." },
                        { q: "They ______ (queue) for tickets for 4 hours!", options: ["queued", "queue", "queuing"], correct: 0, feedback: "Correct! Long duration in past." }
                    ]
                },
                {
                    id: 'habits',
                    title: "Habits in the Past",
                    desc: "Things you used to do but don't do anymore.",
                    questions: [
                        { q: "I ______ (study) French when I was a child.", options: ["studied", "study", "studying"], correct: 0, feedback: "Correct! Past habit." },
                        { q: "He ______ (play) the violin when he was younger.", options: ["played", "plays", "playing"], correct: 0, feedback: "Correct! Past skill/habit." },
                        { q: "She ______ (work) at the cinema after school.", options: ["worked", "works", "working"], correct: 0, feedback: "Correct! Regular past action." },
                        { q: "They never ______ (go) to school; they always skipped.", options: ["went", "go", "gone"], correct: 0, feedback: "Correct! Past routine." },
                        { q: "Did you ______ (play) an instrument when you were a kid?", options: ["play", "played", "playing"], correct: 0, feedback: "Correct! Question about past habit." },
                        { q: "My grandpa always ______ (wear) a hat.", options: ["wore", "worn", "wear"], correct: 0, feedback: "Correct! Past characteristic." },
                        { q: "We often ______ (go) camping in summer.", options: ["went", "go", "going"], correct: 0, feedback: "Correct! Recurring past event." },
                        { q: "I ______ (not / like) vegetables as a child.", options: ["didn't like", "don't like", "not liked"], correct: 0, feedback: "Correct! Past state/habit." },
                        { q: "People ______ (pay) much more for calls in the past.", options: ["paid", "payed", "pay"], correct: 0, feedback: "Correct! General past truth." },
                        { q: "She ______ (be) very shy, but now she's outgoing.", options: ["was", "is", "were"], correct: 0, feedback: "Correct! Past state." }
                    ]
                }
            ],
            pastContinuousPractice: [
                {
                    id: 'interrupted',
                    title: "Interrupted Actions",
                    desc: "Long action in progress interrupted by a short action.",
                    questions: [
                        { q: "I ______ (watch) TV when she called.", options: ["was watching", "watched", "watching"], correct: 0, feedback: "Correct! Interrupted action." },
                        { q: "When the phone rang, she ______ (write) a letter.", options: ["was writing", "wrote", "writes"], correct: 0, feedback: "Correct! Action in progress." },
                        { q: "While we ______ (have) the picnic, it started to rain.", options: ["were having", "had", "having"], correct: 0, feedback: "Correct! Background action." },
                        { q: "What ______ (you / do) when the earthquake started?", options: ["were you doing", "did you do", "do you do"], correct: 0, feedback: "Correct! Action in progress." },
                        { q: "I ______ (listen) to music, so I didn't hear the bell.", options: ["was listening", "listened", "listen"], correct: 0, feedback: "Correct! Reason for not hearing." },
                        { q: "You ______ (not / listen) to me when I told you.", options: ["were not listening", "didn't listen", "not listening"], correct: 0, feedback: "Correct! Negative continuous." },
                        { q: "Sammy ______ (wait) for us when we got off the plane.", options: ["was waiting", "waited", "wait"], correct: 0, feedback: "Correct! Already happening." },
                        { q: "While I ______ (write) the email, the computer crashed.", options: ["was writing", "wrote", "write"], correct: 0, feedback: "Correct! Interrupted process." },
                        { q: "I ______ (snowboard) when I broke my leg.", options: ["was snowboarding", "snowboarded", "snowboard"], correct: 0, feedback: "Correct! Context of accident." },
                        { q: "He ______ (drive) too fast when the police stopped him.", options: ["was driving", "drove", "drives"], correct: 0, feedback: "Correct! Action in progress." }
                    ]
                },
                {
                    id: 'time',
                    title: "Specific Time",
                    desc: "Action in progress at a precise moment in the past.",
                    questions: [
                        { q: "Last night at 6 PM, I ______ (eat) dinner.", options: ["was eating", "ate", "eaten"], correct: 0, feedback: "Correct! In progress at that exact time." },
                        { q: "At midnight, we ______ (still / drive) through the desert.", options: ["were still driving", "still drove", "drive"], correct: 0, feedback: "Correct! Happening precisely then." },
                        { q: "Yesterday at this time, I ______ (sit) at my desk.", options: ["was sitting", "sat", "sit"], correct: 0, feedback: "Correct! In progress at this time yesterday." },
                        { q: "What ______ (you / do) at 8 o'clock last night?", options: ["were you doing", "did you do", "do you do"], correct: 0, feedback: "Correct! Specific time inquiry." },
                        { q: "This time last year, I ______ (live) in Tokyo.", options: ["was living", "lived", "live"], correct: 0, feedback: "Correct! In progress then." },
                        { q: "At 10 AM yesterday, she ______ (work) in the garden.", options: ["was working", "worked", "works"], correct: 0, feedback: "Correct! Ongoing at 10 AM." },
                        { q: "We ______ (sleep) when the alarm went off at 6 AM.", options: ["were sleeping", "slept", "sleep"], correct: 0, feedback: "Correct! State at that time." },
                        { q: "It ______ (rain) heavily at lunchtime.", options: ["was raining", "rained", "rains"], correct: 0, feedback: "Correct! Weather at a specific time." },
                        { q: "They ______ (have) breakfast at 7:30 this morning.", options: ["were having", "had", "have"], correct: 0, feedback: "Correct! Meal in progress." },
                        { q: "I ______ (not / work) at 5 PM; I was already home.", options: ["wasn't working", "didn't work", "not working"], correct: 0, feedback: "Correct! Negative state at specific time." }
                    ]
                },
                {
                    id: 'parallel',
                    title: "Parallel Actions",
                    desc: "Two or more actions happening at the same time.",
                    questions: [
                        { q: "I ______ (study) while he was making dinner.", options: ["was studying", "studied", "study"], correct: 0, feedback: "Correct! Simultaneous action." },
                        { q: "While Ellen was reading, Tim ______ (watch) TV.", options: ["was watching", "watched", "watches"], correct: 0, feedback: "Correct! Happening together." },
                        { q: "______ (you / listen) while he was talking?", options: ["Were you listening", "Did you listen", "Listen you"], correct: 0, feedback: "Correct! Simultaneous actions." },
                        { q: "Thomas wasn't working, and I ______ (not / work) either.", options: ["wasn't working", "didn't work", "not working"], correct: 0, feedback: "Correct! Parallel negative states." },
                        { q: "They ______ (eat) dinner and discussing plans.", options: ["were eating", "ate", "eat"], correct: 0, feedback: "Correct! Multiple ongoing actions." },
                        { q: "While I was cooking, my sister ______ (do) her homework.", options: ["was doing", "did", "does"], correct: 0, feedback: "Correct! Parallel activity." },
                        { q: "He ______ (read) the paper while his wife was driving.", options: ["was reading", "read", "reads"], correct: 0, feedback: "Correct! Happening at the same time." },
                        { q: "The kids ______ (play) while the parents were chatting.", options: ["were playing", "played", "play"], correct: 0, feedback: "Correct! Background scene." },
                        { q: "I ______ (try) to sleep while the neighbours were partying.", options: ["was trying", "tried", "try"], correct: 0, feedback: "Correct! Parallel struggle." },
                        { q: "She ______ (laugh) while he was telling the joke.", options: ["was laughing", "laughed", "laughs"], correct: 0, feedback: "Correct! Simultaneous reaction." }
                    ]
                },
                {
                    id: 'atmosphere',
                    title: "Atmosphere & Repetition",
                    desc: "Setting the scene or describing irritating habits with 'always'.",
                    questions: [
                        { q: "When I walked in, everyone ______ (talk).", options: ["was talking", "talked", "talk"], correct: 0, feedback: "Correct! Setting the scene." },
                        { q: "The birds ______ (sing) and the sun was shining.", options: ["were singing", "sang", "sing"], correct: 0, feedback: "Correct! Atmosphere description." },
                        { q: "She ______ (always / come) to class late!", options: ["was always coming", "always came", "comes always"], correct: 0, feedback: "Correct! Irritating past habit." },
                        { q: "He ______ (constantly / talk). He annoyed everyone.", options: ["was constantly talking", "constantly talked", "talks constantly"], correct: 0, feedback: "Correct! Annoying habit." },
                        { q: "I didn't like them because they ______ (always / complain).", options: ["were always complaining", "always complained", "complain always"], correct: 0, feedback: "Correct! Negative repetition." },
                        { q: "Customers ______ (wait) to be helped.", options: ["were waiting", "waited", "wait"], correct: 0, feedback: "Correct! Scene description." },
                        { q: "Phones ______ (ring) and people were shouting.", options: ["were ringing", "rang", "ring"], correct: 0, feedback: "Correct! Busy atmosphere." },
                        { q: "My old car ______ (always / break) down.", options: ["was always breaking", "always broke", "breaks always"], correct: 0, feedback: "Correct! Annoying frequency." },
                        { q: "The wind ______ (blow) heavily outside.", options: ["was blowing", "blew", "blows"], correct: 0, feedback: "Correct! Atmospheric background." },
                        { q: "He ______ (forever / ask) for money.", options: ["was forever asking", "forever asked", "asks forever"], correct: 0, feedback: "Correct! Hyperbolic habit." }
                    ]
                }
            ],
            perfect: {
                title: "Present Perfect Tenses",
                intro: "Linking the past with the present. Covering both Simple and Continuous forms.",
                units: [
                    {
                        title: "Present Perfect Simple",
                        subtitle: "I have done",
                        formula: "Subject + have/has + past participle (v3)",
                        explanation: "The action is in the past, but the result is in the present. It describes an action at an <b>unspecified time</b> before now.",
                        practiceLink: "present_perfect_hub", 
                        detailedUses: [
                            { title: "1. Result in the Present", desc: "Something happened in the past and has a result now. (e.g., 'I've lost my keys' = I don't have them now)." },
                            { title: "2. Life Experience", desc: "Talking about your life up to now. The exact time is not important. (e.g., 'I have been to France' or 'I have never seen that movie')." },
                            { title: "3. Change Over Time", desc: "Describing a change that has happened over a period of time. (e.g., 'You have grown since the last time I saw you' or 'My English has improved')." },
                            { title: "4. Accomplishments", desc: "Listing accomplishments of individuals or humanity without a specific time. (e.g., 'Man has walked on the Moon' or 'Doctors have cured many diseases')." },
                            { title: "5. Duration (Non-Continuous)", desc: "With non-continuous verbs (like have, know, be), it shows something started in the past and continues to now. (e.g., 'I have had a cold for two weeks')." },
                            { title: "6. Uncompleted Expectation", desc: "An action we expected has not happened yet. (e.g., 'The rain hasn't stopped' or 'James has not finished his homework')." }
                        ],
                        examples: [
                            "I <b>have lost</b> my key. (I don't have it now)",
                            "<b>Have</b> you <b>seen</b> Tom? (Where is he now?)",
                            "My English <b>has really improved</b> since I moved to Australia.",
                            "I <b>have had</b> this car for five years."
                        ],
                        icon: "ph-check-square-offset"
                    },
                    {
                        title: "Present Perfect Continuous",
                        subtitle: "I have been doing",
                        formula: "Subject + have/has + been + verb-ing",
                        explanation: "Use this for an activity that started in the past and has continued up to now, often emphasizing duration or recent activity.",
                        practiceLink: "present_perfect_hub", 
                        detailedUses: [
                            { title: "1. Duration from Past Until Now", desc: "Something started in the past and continues to now. Used with 'for' or 'since'. (e.g., 'They have been talking for the last hour')." },
                            { title: "2. Recently / Lately", desc: "Used without a specific duration to mean 'lately'. Emphasizes recent behavior. (e.g., 'Recently, I have been feeling really tired')." },
                            { title: "3. Activity Recently Stopped (Evidence)", desc: "The activity stopped, but you can see, smell, or feel the result. (e.g., 'Have you been smoking? I smell smoke.' or 'Have you been crying? Your eyes are red.')." },
                            { title: "4. Important: Non-Continuous Verbs", desc: "Do NOT use this tense with non-continuous verbs (like have, know, be). Use Present Perfect Simple instead. (e.g., CORRECT: 'I have had my car for two years' vs INCORRECT: 'I have been having...')." },
                            { title: "5. Adverb Placement", desc: "Adverbs like 'always', 'only', 'never', 'still', 'just' are placed between 'have' and 'been'. (e.g., 'You have ONLY been waiting for one hour')." }
                        ],
                        examples: [
                            "It <b>has been raining</b> for two hours.",
                            "She <b>has been working</b> at that company for three years.",
                            "<b>Have</b> you <b>been exercising</b> lately?",
                            "I <b>have been working</b> hard all day. I'm tired."
                        ],
                        icon: "ph-timer"
                    }
                ]
            },
            presentPerfectPractice: [
                {
                    id: 'simple',
                    title: "Present Perfect Simple",
                    desc: "Experiences, results in the present, and recent news.",
                    questions: [
                        { q: "I ______ (lose) my key. I can't find it anywhere.", options: ["lost", "have lost", "lose"], correct: 1, feedback: "Correct! Result in the present." },
                        { q: "______ (you / ever / be) to Australia?", options: ["Did you ever go", "Have you ever been", "Were you ever"], correct: 1, feedback: "Correct! Asking about life experience." },
                        { q: "She ______ (not / finish) her homework yet.", options: ["hasn't finished", "didn't finish", "not finished"], correct: 0, feedback: "Correct! 'Yet' suggests uncompleted expectation." },
                        { q: "Look! Someone ______ (break) that window.", options: ["broke", "has broken", "breaks"], correct: 1, feedback: "Correct! New information/Result." },
                        { q: "I ______ (know) him for a long time.", options: ["know", "have known", "am knowing"], correct: 1, feedback: "Correct! Duration with non-continuous verb." },
                        { q: "We ______ (already / see) that movie.", options: ["already saw", "have already seen", "had already seen"], correct: 1, feedback: "Correct! Unspecified time before now." },
                        { q: "Where is Jim? He ______ (go) to the shops.", options: ["has gone", "went", "goes"], correct: 0, feedback: "Correct! He is not here now." },
                        { q: "I ______ (never / eat) sushi.", options: ["never ate", "have never eaten", "never eat"], correct: 1, feedback: "Correct! Life experience." },
                        { q: "______ (you / hear) from George recently?", options: ["Did you hear", "Have you heard", "Do you hear"], correct: 1, feedback: "Correct! News/Recent event." },
                        { q: "They ______ (live) in this house since 2010.", options: ["lived", "have lived", "live"], correct: 1, feedback: "Correct! Started in past, continues now (state)." }
                    ]
                },
                {
                    id: 'continuous',
                    title: "Present Perfect Continuous",
                    desc: "Duration of activity, recent actions, and visible evidence.",
                    questions: [
                        { q: "It ______ (rain) for two hours.", options: ["is raining", "has been raining", "rains"], correct: 1, feedback: "Correct! Emphasizes duration." },
                        { q: "You look tired. ______ (you / work) hard?", options: ["Have you been working", "Do you work", "Are you working"], correct: 0, feedback: "Correct! Evidence (tiredness) from recent activity." },
                        { q: "She ______ (learn) English for six months.", options: ["has been learning", "is learning", "learns"], correct: 0, feedback: "Correct! Duration of an ongoing activity." },
                        { q: "I ______ (wait) here since 9 o'clock!", options: ["am waiting", "wait", "have been waiting"], correct: 2, feedback: "Correct! Emphasis on length of time." },
                        { q: "Sorry I'm late. ______ (you / wait) long?", options: ["Do you wait", "Are you waiting", "Have you been waiting"], correct: 2, feedback: "Correct! Activity continuing up to now." },
                        { q: "My hands are dirty. I ______ (repair) my bike.", options: ["have been repairing", "repaired", "am repairing"], correct: 0, feedback: "Correct! Evidence of recent activity." },
                        { q: "How long ______ (you / play) tennis?", options: ["do you play", "have you been playing", "are you playing"], correct: 1, feedback: "Correct! Question about duration." },
                        { q: "He ______ (watch) TV all day.", options: ["is watching", "has been watching", "watches"], correct: 1, feedback: "Correct! 'All day' emphasizes continuous duration." },
                        { q: "The kitchen is a mess. They ______ (cook).", options: ["have been cooking", "cooked", "cook"], correct: 0, feedback: "Correct! Recent activity with visible result." },
                        { q: "I ______ (think) about what you said lately.", options: ["have been thinking", "think", "am thinking"], correct: 0, feedback: "Correct! Mental activity over a recent period." }
                    ]
                }
            ],
            pastPerfect: {
                title: "Past Perfect Tenses",
                intro: "Going back to a time before the past. Covering Simple and Continuous forms.",
                units: [
                    {
                        title: "Past Perfect Simple",
                        subtitle: "I had done",
                        formula: "Subject + had + past participle (v3)",
                        explanation: "We use the Past Perfect to indicate that an action happened <b>before</b> another action in the past. It clarifies the timeline of events.",
                        practiceLink: "past_perfect_hub",
                        detailedUses: [
                            { title: "1. Action Before Another Past Action", desc: "Something occurred before another action in the past. (e.g., 'I had never seen such a beautiful beach before I went to Kauai')." },
                            { title: "2. Duration Before Past Event", desc: "With non-continuous verbs, shows something started in the past and continued until another past action. (e.g., 'We had had that car for ten years before it broke down')." },
                            { title: "3. Specific Times Allowed", desc: "Unlike Present Perfect, you CAN use specific times to clarify order. (e.g., 'She had visited once in 1993 before she moved')." },
                            { title: "4. Clarifying Meaning", desc: "Compare: 'When I arrived, he left' (Sequence) vs 'When I arrived, he had left' (He was already gone)." },
                            { title: "5. Reported Speech", desc: "Present Perfect/Past Simple becomes Past Perfect in reported speech. (e.g., 'I have lost my key' -> He said he had lost his key)." }
                        ],
                        examples: [
                            "When Sarah arrived at the party, Paul <b>had</b> already <b>gone</b> home.",
                            "We <b>had had</b> that car for ten years before it broke down.",
                            "The house was dirty. They <b>hadn't cleaned</b> it for weeks."
                        ],
                        icon: "ph-arrow-u-up-left"
                    },
                    {
                        title: "Past Perfect Continuous",
                        subtitle: "I had been doing",
                        formula: "Subject + had + been + verb-ing",
                        explanation: "Use this to describe an action that had been happening for a period of time before another action in the past.",
                        practiceLink: "past_perfect_hub",
                        detailedUses: [
                            { title: "1. Duration Before Past Event", desc: "Something started in the past and continued up to another past time. (e.g., 'We had been playing tennis for 30 minutes when it started to rain')." },
                            { title: "2. Cause of a Past State", desc: "Explaining why a past condition existed. (e.g., 'He was tired because he had been working hard')." },
                            { title: "3. VS Past Continuous", desc: "Past Continuous (at the time): 'He was running'. Past Perfect Continuous (finished/result): 'He had been running'." }
                        ],
                        examples: [
                            "I was very tired when I arrived home. I <b>had been working</b> hard all day.",
                            "The game was stopped because it <b>had been raining</b> heavily.",
                            "Ken gave up smoking two years ago. He <b>had been smoking</b> for 30 years."
                        ],
                        icon: "ph-timer"
                    }
                ]
            },
            pastPerfectPractice: [
                {
                    id: 'simple',
                    title: "Past Perfect Simple",
                    desc: "Actions completed before another past time.",
                    questions: [
                        { q: "When I arrived at the party, Paul ______ (already / go) home.", options: ["already went", "had already gone", "has already gone"], correct: 1, feedback: "Correct! Happened before I arrived." },
                        { q: "We weren't hungry. We ______ (just / have) lunch.", options: ["just had", "had just had", "have just had"], correct: 1, feedback: "Correct! Action completed before past state (not hungry)." },
                        { q: "The house was quiet. Everybody ______ (go) to bed.", options: ["went", "had gone", "was going"], correct: 1, feedback: "Correct! Completed before the past time (was quiet)." },
                        { q: "I didn't recognize him. He ______ (change) a lot.", options: ["changed", "had changed", "has changed"], correct: 1, feedback: "Correct! Change happened before I saw him." },
                        { q: "The car broke down because I ______ (forget) to put oil in it.", options: ["forgot", "had forgotten", "forget"], correct: 1, feedback: "Correct! The forgetting happened before the breakdown." },
                        { q: "She ______ (never / see) a bear before she moved to Alaska.", options: ["never saw", "had never seen", "never sees"], correct: 1, feedback: "Correct! Experience before a past event." },
                        { q: "By the time the police arrived, the thief ______ (escape).", options: ["escaped", "had escaped", "escapes"], correct: 1, feedback: "Correct! Escaped before arrival." },
                        { q: "I realized I ______ (leave) my wallet at home.", options: ["left", "had left", "leave"], correct: 1, feedback: "Correct! Realized later about an earlier action." },
                        { q: "The film ______ (already / start) when we got to the cinema.", options: ["already started", "had already started", "starts"], correct: 1, feedback: "Correct! Started before we arrived." },
                        { q: "He told me he ______ (buy) a new computer.", options: ["bought", "had bought", "buys"], correct: 1, feedback: "Correct! Reported speech (bought -> had bought)." }
                    ]
                },
                {
                    id: 'continuous',
                    title: "Past Perfect Continuous",
                    desc: "Duration up to a past moment and causes of past states.",
                    questions: [
                        { q: "I was tired. I ______ (work) hard all day.", options: ["was working", "had been working", "worked"], correct: 1, feedback: "Correct! Duration leading up to a past state." },
                        { q: "Her eyes were red. She ______ (cry).", options: ["was crying", "had been crying", "cried"], correct: 1, feedback: "Correct! Evidence of a recent past activity." },
                        { q: "We ______ (play) tennis for 30 minutes when it started to rain.", options: ["were playing", "had been playing", "played"], correct: 1, feedback: "Correct! Duration up to the interruption." },
                        { q: "Ken gave up smoking. He ______ (smoke) for 30 years.", options: ["smoked", "had been smoking", "was smoking"], correct: 1, feedback: "Correct! Duration up to a past point (gave up)." },
                        { q: "The road was wet. It ______ (rain).", options: ["rained", "had been raining", "was raining"], correct: 1, feedback: "Correct! Cause of the past state." },
                        { q: "They were angry. They ______ (wait) for over an hour.", options: ["were waiting", "had been waiting", "waited"], correct: 1, feedback: "Correct! Duration causing the feeling." },
                        { q: "How long ______ (you / learn) English before you moved to London?", options: ["were you learning", "had you been learning", "did you learn"], correct: 1, feedback: "Correct! Duration before a past event." },
                        { q: "I was out of breath. I ______ (run).", options: ["ran", "had been running", "was running"], correct: 1, feedback: "Correct! Recent activity causing a state." },
                        { q: "He gained weight because he ______ (eat) too much.", options: ["was eating", "had been eating", "ate"], correct: 1, feedback: "Correct! Repeated action leading to a result." },
                        { q: "They ______ (drive) all night, so they were exhausted.", options: ["drove", "had been driving", "were driving"], correct: 1, feedback: "Correct! Duration causing exhaustion." }
                    ]
                }
            ],
            // Removed compare data completely
            quiz: [
                {
                    q: "Look! That man ______ to open the door of your car.",
                    options: ["tries", "is trying", "tried"],
                    correct: 1, // Index of correct option
                    feedback: "Correct! We use Present Continuous for actions happening right now (Look!)."
                },
                {
                    q: "Can you hear those people? What ______ about?",
                    options: ["do they talk", "are they talking", "talk they"],
                    correct: 1,
                    feedback: "Correct! The action is happening now, so we use Present Continuous."
                },
                {
                    q: "The moon ______ round the earth in about 27 days.",
                    options: ["goes", "is going", "went"],
                    correct: 0,
                    feedback: "Correct! This is a general truth/scientific fact, so we use Present Simple."
                },
                {
                    q: "I ______ (see) Josh yesterday evening.",
                    options: ["was seeing", "saw", "seen"],
                    correct: 1,
                    feedback: "Correct! 'Yesterday evening' indicates a finished time in the past."
                },
                {
                    q: "I ______ (walk) along the road when I saw Dave.",
                    options: ["walked", "was walking", "am walking"],
                    correct: 1,
                    feedback: "Correct! You were in the middle of the action when something else happened."
                },
                {
                    q: "From the PDF Letter: 'I ______ (have) a great time here in England.'",
                    options: ["have", "am having", "had"],
                    correct: 1,
                    feedback: "Correct! This is happening around the present time (temporary situation)."
                }
            ]
        };

        // --- Application Logic ---

        const app = {
            container: document.getElementById('app-container'),
            currentQuizIndex: 0,
            score: 0,
            currentQuizData: [], // Stores the active quiz questions

            init() {
                this.navigate('home');
            },

            navigate(view) {
                // Close mobile menu if open
                document.getElementById('mobile-menu').classList.add('hidden');
                
                // Render view
                this.container.innerHTML = '';
                window.scrollTo(0, 0);

                switch(view) {
                    case 'home': this.renderHome(); break;
                    case 'present': this.renderGrammar('present'); break;
                    case 'present_simple_hub': this.renderPresentSimpleHub(); break;
                    case 'present_continuous_hub': this.renderPresentContinuousHub(); break;
                    case 'past': this.renderGrammar('past'); break;
                    case 'past_simple_hub': this.renderPastSimpleHub(); break;
                    case 'past_continuous_hub': this.renderPastContinuousHub(); break;
                    case 'perfect': this.renderGrammar('perfect'); break;
                    case 'present_perfect_hub': this.renderPresentPerfectHub(); break;
                    case 'pastPerfect': this.renderGrammar('pastPerfect'); break;
                    case 'past_perfect_hub': this.renderPastPerfectHub(); break;
                    // Removed case 'compare'
                    case 'practice': this.startGeneralQuiz(); break;
                }
            },

            startGeneralQuiz() {
                this.currentQuizData = contentData.quiz;
                this.renderPractice();
            },
            
            startSpecificQuiz(categoryIndex, dataKey) {
                 this.currentQuizData = contentData[dataKey][categoryIndex].questions;
                 this.renderPractice();
            },

            renderHome() {
                const data = contentData.home;
                let html = `
                    <div class="text-center py-12 fade-in">
                        <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 drop-shadow-sm tracking-tight">${data.title}</h1>
                        <p class="text-xl text-blue-100 max-w-2xl mx-auto mb-12 font-light">${data.subtitle}</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${data.cards.map(card => `
                                <div onclick="app.navigate('${card.action}')" class="glass-card cursor-pointer p-6 rounded-2xl border-t-4 border-transparent hover:border-white group relative overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-br ${card.color} opacity-10 group-hover:opacity-20 transition-opacity"></div>
                                    <div class="relative z-10 flex flex-col items-center">
                                        <div class="w-16 h-16 rounded-full bg-gradient-to-br ${card.color} flex items-center justify-center text-white mb-4 shadow-lg group-hover:scale-110 transition-transform">
                                            <i class="ph-fill ${card.icon} text-3xl"></i>
                                        </div>
                                        <h3 class="text-xl font-bold text-slate-800 mb-2">${card.title}</h3>
                                        <p class="text-sm text-slate-600">${card.desc}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                this.container.innerHTML = html;
            },
            
            renderPresentSimpleHub() {
                 let html = `
                    <div class="fade-in max-w-6xl mx-auto">
                        <div class="text-center mb-10">
                            <h1 class="text-4xl font-bold text-white mb-3">Present Simple Practice</h1>
                            <p class="text-lg text-blue-100">Select a specific use to practice.</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${contentData.presentSimplePractice.map((cat, idx) => `
                                <div onclick="app.startSpecificQuiz(${idx}, 'presentSimplePractice')" class="glass-card cursor-pointer p-8 rounded-2xl border-l-8 border-indigo-500 hover:bg-white/90 transition-all">
                                    <h3 class="text-2xl font-bold text-slate-800 mb-2">${cat.title}</h3>
                                    <p class="text-slate-600 mb-4">${cat.desc}</p>
                                    <div class="flex items-center text-indigo-600 font-bold text-sm">
                                        Start Quiz (${cat.questions.length} Questions) <i class="ph-bold ph-arrow-right ml-2"></i>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-8 text-center">
                             <button onclick="app.navigate('present')" class="text-white hover:text-indigo-200 underline">Back to Present Tenses</button>
                        </div>
                    </div>
                 `;
                 this.container.innerHTML = html;
            },

            renderPresentContinuousHub() {
                 let html = `
                    <div class="fade-in max-w-6xl mx-auto">
                        <div class="text-center mb-10">
                            <h1 class="text-4xl font-bold text-white mb-3">Present Continuous Practice</h1>
                            <p class="text-lg text-blue-100">Select a specific use to practice.</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${contentData.presentContinuousPractice.map((cat, idx) => `
                                <div onclick="app.startSpecificQuiz(${idx}, 'presentContinuousPractice')" class="glass-card cursor-pointer p-8 rounded-2xl border-l-8 border-blue-500 hover:bg-white/90 transition-all">
                                    <h3 class="text-2xl font-bold text-slate-800 mb-2">${cat.title}</h3>
                                    <p class="text-slate-600 mb-4">${cat.desc}</p>
                                    <div class="flex items-center text-blue-600 font-bold text-sm">
                                        Start Quiz (${cat.questions.length} Questions) <i class="ph-bold ph-arrow-right ml-2"></i>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-8 text-center">
                             <button onclick="app.navigate('present')" class="text-white hover:text-indigo-200 underline">Back to Present Tenses</button>
                        </div>
                    </div>
                 `;
                 this.container.innerHTML = html;
            },

            renderPastSimpleHub() {
                 let html = `
                    <div class="fade-in max-w-6xl mx-auto">
                        <div class="text-center mb-10">
                            <h1 class="text-4xl font-bold text-white mb-3">Past Simple Practice</h1>
                            <p class="text-lg text-blue-100">Select a specific use to practice.</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${contentData.pastSimplePractice.map((cat, idx) => `
                                <div onclick="app.startSpecificQuiz(${idx}, 'pastSimplePractice')" class="glass-card cursor-pointer p-8 rounded-2xl border-l-8 border-pink-500 hover:bg-white/90 transition-all">
                                    <h3 class="text-2xl font-bold text-slate-800 mb-2">${cat.title}</h3>
                                    <p class="text-slate-600 mb-4">${cat.desc}</p>
                                    <div class="flex items-center text-pink-600 font-bold text-sm">
                                        Start Quiz (${cat.questions.length} Questions) <i class="ph-bold ph-arrow-right ml-2"></i>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-8 text-center">
                             <button onclick="app.navigate('past')" class="text-white hover:text-pink-200 underline">Back to Past Tenses</button>
                        </div>
                    </div>
                 `;
                 this.container.innerHTML = html;
            },

            renderPastContinuousHub() {
                 let html = `
                    <div class="fade-in max-w-6xl mx-auto">
                        <div class="text-center mb-10">
                            <h1 class="text-4xl font-bold text-white mb-3">Past Continuous Practice</h1>
                            <p class="text-lg text-blue-100">Select a specific use to practice.</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${contentData.pastContinuousPractice.map((cat, idx) => `
                                <div onclick="app.startSpecificQuiz(${idx}, 'pastContinuousPractice')" class="glass-card cursor-pointer p-8 rounded-2xl border-l-8 border-rose-500 hover:bg-white/90 transition-all">
                                    <h3 class="text-2xl font-bold text-slate-800 mb-2">${cat.title}</h3>
                                    <p class="text-slate-600 mb-4">${cat.desc}</p>
                                    <div class="flex items-center text-rose-600 font-bold text-sm">
                                        Start Quiz (${cat.questions.length} Questions) <i class="ph-bold ph-arrow-right ml-2"></i>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-8 text-center">
                             <button onclick="app.navigate('past')" class="text-white hover:text-rose-200 underline">Back to Past Tenses</button>
                        </div>
                    </div>
                 `;
                 this.container.innerHTML = html;
            },

            renderPresentPerfectHub() {
                 let html = `
                    <div class="fade-in max-w-6xl mx-auto">
                        <div class="text-center mb-10">
                            <h1 class="text-4xl font-bold text-white mb-3">Present Perfect Practice</h1>
                            <p class="text-lg text-blue-100">Practice Simple vs. Continuous forms.</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${contentData.presentPerfectPractice.map((cat, idx) => `
                                <div onclick="app.startSpecificQuiz(${idx}, 'presentPerfectPractice')" class="glass-card cursor-pointer p-8 rounded-2xl border-l-8 border-emerald-500 hover:bg-white/90 transition-all">
                                    <h3 class="text-2xl font-bold text-slate-800 mb-2">${cat.title}</h3>
                                    <p class="text-slate-600 mb-4">${cat.desc}</p>
                                    <div class="flex items-center text-emerald-600 font-bold text-sm">
                                        Start Quiz (${cat.questions.length} Questions) <i class="ph-bold ph-arrow-right ml-2"></i>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-8 text-center">
                             <button onclick="app.navigate('perfect')" class="text-white hover:text-emerald-200 underline">Back to Present Perfect</button>
                        </div>
                    </div>
                 `;
                 this.container.innerHTML = html;
            },

            renderPastPerfectHub() {
                 let html = `
                    <div class="fade-in max-w-6xl mx-auto">
                        <div class="text-center mb-10">
                            <h1 class="text-4xl font-bold text-white mb-3">Past Perfect Practice</h1>
                            <p class="text-lg text-blue-100">Practice Simple vs. Continuous forms.</p>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${contentData.pastPerfectPractice.map((cat, idx) => `
                                <div onclick="app.startSpecificQuiz(${idx}, 'pastPerfectPractice')" class="glass-card cursor-pointer p-8 rounded-2xl border-l-8 border-violet-500 hover:bg-white/90 transition-all">
                                    <h3 class="text-2xl font-bold text-slate-800 mb-2">${cat.title}</h3>
                                    <p class="text-slate-600 mb-4">${cat.desc}</p>
                                    <div class="flex items-center text-violet-600 font-bold text-sm">
                                        Start Quiz (${cat.questions.length} Questions) <i class="ph-bold ph-arrow-right ml-2"></i>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-8 text-center">
                             <button onclick="app.navigate('pastPerfect')" class="text-white hover:text-violet-200 underline">Back to Past Perfect</button>
                        </div>
                    </div>
                 `;
                 this.container.innerHTML = html;
            },

            renderGrammar(type) {
                const data = contentData[type];
                // Determine theme color based on type
                let themeColor = 'indigo';
                let gradientClass = 'from-indigo-600 to-blue-600';
                let borderClass = 'border-indigo-500';
                let practiceHubLink = ''; // Variable to hold the specific hub link
                
                if (type === 'present') {
                    practiceHubLink = 'practice_present_general'; // We can create a general practice view or link to specific hubs
                } else if (type === 'past') {
                    themeColor = 'pink';
                    gradientClass = 'from-pink-600 to-rose-600';
                    borderClass = 'border-pink-500';
                } else if (type === 'perfect') {
                    themeColor = 'emerald';
                    gradientClass = 'from-emerald-500 to-teal-600';
                    borderClass = 'border-emerald-500';
                } else if (type === 'pastPerfect') {
                    themeColor = 'violet';
                    gradientClass = 'from-violet-500 to-fuchsia-600';
                    borderClass = 'border-violet-500';
                }
                
                // Collect practice links
                const practiceButtons = data.units.filter(u => u.practiceLink).map(u => ({
                    title: u.title,
                    link: u.practiceLink
                }));
                
                let html = `
                    <div class="fade-in max-w-5xl mx-auto">
                        <div class="text-center mb-10">
                            <h1 class="text-4xl font-bold text-white mb-3">${data.title}</h1>
                            <p class="text-lg text-blue-100">${data.intro}</p>
                        </div>

                        <div class="space-y-8">
                            ${data.units.map(unit => `
                                <div class="glass-panel p-0 rounded-3xl overflow-hidden shadow-xl">
                                    <div class="bg-gradient-to-r ${gradientClass} p-6 flex items-center justify-between">
                                        <div>
                                            <h2 class="text-2xl font-bold text-white">${unit.title}</h2>
                                            <p class="text-white/80 font-mono text-sm mt-1">${unit.subtitle}</p>
                                        </div>
                                        <i class="ph ${unit.icon} text-4xl text-white/50"></i>
                                    </div>
                                    <div class="p-6 md:p-8 bg-white/95">
                                        <div class="mb-6">
                                            <div class="inline-block px-4 py-2 bg-slate-100 rounded-lg text-slate-700 font-mono text-sm font-semibold border-l-4 ${borderClass}">
                                                ${unit.formula}
                                            </div>
                                        </div>
                                        <p class="text-slate-700 text-lg mb-6 leading-relaxed">${unit.explanation}</p>
                                        
                                        ${unit.detailedUses ? `
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                                ${unit.detailedUses.map(use => `
                                                    <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
                                                        <span class="block text-indigo-700 font-bold text-sm mb-1">${use.title}</span>
                                                        <span class="text-slate-600 text-sm leading-snug block">${use.desc}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        ` : ''}

                                        <div class="bg-slate-50 rounded-xl p-5 border border-slate-200">
                                            <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-3">Examples</h4>
                                            <ul class="space-y-3">
                                                ${unit.examples.map(ex => `
                                                    <li class="flex items-start gap-3 text-slate-700">
                                                        <i class="ph-fill ph-check-circle text-emerald-500 mt-1"></i>
                                                        <span>${ex}</span>
                                                    </li>
                                                `).join('')}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <!-- Practice Buttons Section (Specific Unit Practice) -->
                        ${practiceButtons.length > 0 ? `
                            <div class="mt-12 grid grid-cols-1 md:grid-cols-${practiceButtons.length > 1 ? '2' : '1'} gap-6">
                                ${practiceButtons.map(btn => `
                                    <button onclick="app.navigate('${btn.link}')" class="bg-white hover:bg-indigo-50 text-slate-800 font-bold py-4 px-6 rounded-2xl shadow-lg transition-all transform hover:scale-105 border-2 border-indigo-100 flex flex-col items-center justify-center gap-2 group">
                                        <i class="ph-duotone ph-pencil-simple text-3xl text-indigo-600 group-hover:text-indigo-700"></i>
                                        <span class="text-lg">Practice ${btn.title}</span>
                                        <span class="text-xs text-slate-500 font-normal">Interactive Exercises</span>
                                    </button>
                                `).join('')}
                            </div>
                        ` : ''}
                        
                        <!-- Comparison Link (Only for Present/Past/Perfect main sections if applicable) -->
                        ${type === 'present' ? `
                        <div class="mt-8 text-center">
                            <button onclick="app.navigate('compare')" class="bg-white/10 text-white hover:bg-white/20 px-8 py-3 rounded-full font-bold shadow-lg transition-all backdrop-blur-sm border border-white/20">
                                <span class="flex items-center gap-3">
                                    <i class="ph-bold ph-arrows-left-right text-xl"></i>
                                    Compare Present Simple vs Present Continuous
                                </span>
                            </button>
                        </div>
                        ` : ''}

                        <!-- Bottom Navigation to Home -->
                        <div class="mt-12 pt-8 border-t border-white/10 flex justify-center">
                            <button onclick="app.navigate('home')" class="text-blue-100 hover:text-white flex items-center gap-2 transition-colors">
                                <i class="ph-bold ph-house"></i> Back to Home
                            </button>
                        </div>
                    </div>
                `;
                this.container.innerHTML = html;
            },

            checkAnswer(selectedIndex) {
                const q = this.currentQuizData[this.currentQuizIndex];
                const buttons = document.querySelectorAll('.option-btn');
                const feedbackArea = document.getElementById('feedback-area');
                const feedbackText = document.getElementById('feedback-text');
                const nextBtn = document.getElementById('next-btn');

                // Disable all buttons
                buttons.forEach(btn => {
                    btn.disabled = true;
                    btn.classList.add('opacity-50', 'cursor-not-allowed');
                });

                if (selectedIndex === q.correct) {
                    // Correct
                    buttons[selectedIndex].classList.remove('border-slate-200', 'opacity-50');
                    buttons[selectedIndex].classList.add('border-emerald-500', 'bg-emerald-50', 'text-emerald-700');
                    
                    feedbackArea.classList.remove('hidden');
                    feedbackArea.classList.add('bg-emerald-100', 'text-emerald-800');
                    feedbackText.innerHTML = `<i class="ph-bold ph-check"></i> ${q.feedback}`;
                    this.score++;
                } else {
                    // Incorrect
                    buttons[selectedIndex].classList.remove('border-slate-200', 'opacity-50');
                    buttons[selectedIndex].classList.add('border-red-500', 'bg-red-50', 'text-red-700');
                    
                    // Highlight correct one
                    buttons[q.correct].classList.remove('border-slate-200', 'opacity-50');
                    buttons[q.correct].classList.add('border-emerald-500', 'bg-emerald-50', 'text-emerald-700');

                    feedbackArea.classList.remove('hidden');
                    feedbackArea.classList.add('bg-red-100', 'text-red-800');
                    feedbackText.innerHTML = `<i class="ph-bold ph-x"></i> Incorrect. The correct answer was <b>${q.options[q.correct]}</b>.`;
                }

                nextBtn.classList.remove('hidden');
            },

            nextQuestion() {
                if (this.currentQuizIndex < this.currentQuizData.length - 1) {
                    this.currentQuizIndex++;
                    this.renderQuizQuestion();
                } else {
                    this.renderResults();
                }
            },

            renderResults() {
                const total = this.currentQuizData.length;
                const percentage = (this.score / total) * 100;
                let message = "";
                if (percentage === 100) message = "Perfect Score! You're a grammar wizard! ";
                else if (percentage >= 70) message = "Great job! You have a solid understanding. ";
                else message = "Keep practicing! Review the notes and try again. ";

                this.container.innerHTML = `
                    <div class="fade-in max-w-2xl mx-auto text-center mt-10">
                        <div class="glass-panel p-10 rounded-3xl">
                            <div class="w-24 h-24 bg-gradient-to-tr from-fuchsia-500 to-purple-600 rounded-full mx-auto flex items-center justify-center mb-6 shadow-lg">
                                <i class="ph-fill ph-trophy text-4xl text-white"></i>
                            </div>
                            <h2 class="text-3xl font-bold text-slate-800 mb-2">Quiz Complete!</h2>
                            <p class="text-slate-600 mb-8">${message}</p>
                            
                            <div class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-fuchsia-600 mb-2">
                                ${this.score} / ${total}
                            </div>
                            <p class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-10">Your Score</p>

                            <div class="flex gap-4 justify-center">
                                <button onclick="app.navigate('home')" class="px-6 py-3 rounded-xl bg-slate-100 text-slate-700 font-bold hover:bg-slate-200 transition-colors">
                                    Home
                                </button>
                                <button onclick="app.renderPractice()" class="px-6 py-3 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 shadow-lg transition-transform transform hover:scale-105">
                                    Try Again
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

    </script>
</body>
</html>
